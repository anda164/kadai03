# 課題03 LocalStorageを使ったアプリ
## ①課題内容（Javascript/LocalStorage）
- Excel地獄から解放するweb帳票入力UI
- 長らく主流となっているExcel帳票の利点を残しつつWeb化する事でデータの流通性を高めることを目的とする
- 従来のExcelファイル添付型ではファイルの共有、保管、流通に難がある
- 一方、Webアプリ化するとデータの保管や共有を行いやすっ苦する一方、データ入力UIの操作性でExcelに劣る
- これら課題に対し、WebフォームにExcel入力の良いところを取り入れる事で、Web上で直接作業する感覚で帳票作成ができるアプリを目標とする
 
## ②工夫した点・こだわった点
- サーバー側にデータを引き渡した（今回は未開発）時点で正規に「発行」したとみなすが、その手前の編集過程でフォームへの入力内容を喪失しないよう逐次記録を残す機能をLocalStorageで実現
- 保存データは、帳票出力内容のヘッダー部から明細部までをJSONでパッケージ化し、帳票ID単位でLocalStorageに保存
- 帳票IDの管理においては仮にLocalStorageに払い出し番号を記録した自動採番関数を実装（将来的にはサーバー管理・ユーザーID単位でローカル払い出し等の選択も検討）
- Excelライクな操作はオープンソースのjspreadsheet CE (旧JExcel)を使用
## ③質問・疑問
- 操作の途中、キー入力の設定が強制的に変わってしまい入力操作ができなくなる(mac、fnを押しながらキーを叩くと入力される)問題が発生、未解決
- jspreadsheetの明細フッター部の初期表示で不具合があり、未解決（初期表示配列内の値「Total:」ではなく、「￥」が表示されてしまう。1行入力すると更新される）

## ④その他（感想、シェアしたいことなんでも）
- LocalStorageは保存前の加工により、いろいろなものが保存できることを学んだ
- Web上でExcelライクな操作を実装してみたかったのでjspreadsheetを試してみた。プルダウンやカレンダーなど入力UIも充実していて便利に利用ができそうであったが、微妙な操作感や表示、ちょっとした不具合など、その修正対応に苦労した。学習コストや細かいこだわりを考えると、少し苦労しても自作も考えるべきなのかと思った
